// Generated by CoffeeScript 1.6.3
$(document).ready(function() {
  var back, calculateNewId, checkLocalStorage, clearStorage, init, loadNotes, setListeners;
  checkLocalStorage = function() {
    var e;
    try {
      return 'localStorage' in window;
    } catch (_error) {
      e = _error;
      return false;
    }
  };
  clearStorage = function() {
    return localStorage.clear();
  };
  back = function() {
    $('#back').hide();
    $('#newNote').hide();
    return $('#createNote').show();
  };
  calculateNewId = function() {
    var notes;
    if (!$.isEmptyObject(localStorage)) {
      return notes = JSON.parse(localStorage['chromeNotes']);
    }
  };
  setListeners = function() {
    $('#removeAll').on('click', function() {
      var ans;
      ans = confirm("Are you sure you want to remove all notes?");
      if (ans) {
        return clearStorage();
      }
    });
    $('#createNote').on('click', function() {
      $(this).hide();
      $('#back').show();
      $('#newNote').show();
      $('#title').empty();
      return $('#content').empty();
    });
    $('#saveNote').on('click', function() {
      var ar, newId, newNote, notes;
      notes = JSON.parse(localStorage['chromeNotes']);
      if (notes.length > 0) {
        return newId = calculateNewId();
      } else {
        localStorage['chromeNotes'] = '';
        newNote = {
          "id": '000',
          "title": $('#title').val().trim(),
          "content": $('#content').val().trim()
        };
        ar = [newNote];
        localStorage['chromeNotes'] = JSON.stringify(ar);
        return back();
      }
    });
    return $('#back').on('click', function() {
      return back();
    });
  };
  loadNotes = function() {
    var notes;
    if (!$.isEmptyObject(localStorage)) {
      return notes = JSON.parse(localStorage['chromeNotes']);
    }
  };
  init = function() {
    var storageSupport;
    storageSupport = checkLocalStorage();
    $('#newNote').hide();
    $('#back').hide();
    if (storageSupport) {
      setListeners();
      return loadNotes();
    }
  };
  return init();
});
